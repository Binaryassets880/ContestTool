<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grand Arena Contest Tool</title>

    <!-- Tabulator CSS -->
    <link href="https://unpkg.com/tabulator-tables@5.5.0/dist/css/tabulator.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/static/styles.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header>
            <h1>Grand Arena Contest Tool</h1>
        </header>

        <nav class="tabs">
            <button class="tab active" data-tab="upcoming">Upcoming Matchups</button>
            <button class="tab" data-tab="schemes">Schemes</button>
            <button class="tab" data-tab="analysis">Analysis</button>
            <button class="tab" data-tab="class-changes">Class Changes</button>
            <button class="tab" data-tab="team-comps">Team Comps</button>
        </nav>

        <main>
            <section id="upcoming" class="tab-content active">
                <div class="controls">
                    <input type="text" id="search" placeholder="Search champions...">
                    <select id="class-filter">
                        <option value="">All Classes</option>
                        <option value="Defender">Defender</option>
                        <option value="Striker">Striker</option>
                        <option value="Sprinter">Sprinter</option>
                        <option value="Bruiser">Bruiser</option>
                        <option value="Center">Center</option>
                        <option value="Grinder">Grinder</option>
                        <option value="Forward">Forward</option>
                        <option value="Flanker">Flanker</option>
                        <option value="Support">Support</option>
                        <option value="Anchor">Anchor</option>
                    </select>
                </div>
                <div id="table-wrapper">
                    <div id="upcoming-table"></div>
                    <div id="detail-panel" class="detail-panel hidden"></div>
                </div>
            </section>

            <section id="schemes" class="tab-content">
                <div class="schemes-header">
                    <h2>Scheme Matcher</h2>
                    <p>Find champions that match trait-based schemes for bonus points.</p>
                </div>
                <div class="controls">
                    <select id="scheme-filter">
                        <option value="">All Schemes</option>
                        <option value="Costume Party">Costume Party</option>
                        <option value="Shapeshifting">Shapeshifting</option>
                        <option value="Midnight Strike">Midnight Strike</option>
                        <option value="Dress to Impress">Dress to Impress</option>
                        <option value="Housekeeping">Housekeeping</option>
                        <option value="Dungaree Duel">Dungaree Duel</option>
                        <option value="Tear Jerking">Tear Jerking</option>
                        <option value="Golden Shower">Golden Shower</option>
                        <option value="Rainbow Riot">Rainbow Riot</option>
                        <option value="Divine Intervention">Divine Intervention</option>
                        <option value="Whale Watching">Whale Watching</option>
                        <option value="Call to Arms">Call to Arms</option>
                        <option value="Malicious Intent">Malicious Intent</option>
                    </select>
                    <input type="text" id="scheme-search" placeholder="Search champions...">
                    <label class="checkbox-label">
                        <input type="checkbox" id="scheme-upcoming-only" checked>
                        Only with upcoming games
                    </label>
                </div>
                <div id="schemes-table-wrapper">
                    <div id="schemes-table"></div>
                    <div id="scheme-detail-panel" class="detail-panel hidden"></div>
                </div>
            </section>

            <section id="analysis" class="tab-content">
                <div class="analysis-header">
                    <h2>Matchup Score Analysis <span class="info-icon" id="ms-info-btn">i</span></h2>
                    <p>Backtesting matchup scores against historical results to find optimal thresholds.</p>
                    <div class="info-overlay" id="ms-info-overlay">
                        <div class="info-content">
                            <h3>Matchup Score (MS) v3.3</h3>
                            <p><strong>MS = Base WR + Class Adj + Supporter Adj - Gacha Threat</strong></p>
                            <p style="color:#00d4ff;font-size:12px;margin-bottom:10px;"><strong>Realistic bounds: 25-75</strong> (no matchup is ever 0% or 100%)</p>

                            <h4 style="margin-top:15px;">Letter Grades</h4>
                            <div style="display:flex;flex-wrap:wrap;gap:8px;font-size:12px;margin-bottom:12px;">
                                <span style="background:#00ff88;color:#000;padding:3px 8px;border-radius:3px;font-weight:bold;">A (70+) Must-play</span>
                                <span style="background:#88ff88;color:#000;padding:3px 8px;border-radius:3px;">B (60-69) Good</span>
                                <span style="background:#ffcc00;color:#000;padding:3px 8px;border-radius:3px;">C (50-59) Coin flip</span>
                                <span style="background:#ff9900;color:#000;padding:3px 8px;border-radius:3px;">D (40-49) Avoid</span>
                                <span style="background:#ff4444;color:#fff;padding:3px 8px;border-radius:3px;font-weight:bold;">F (&lt;40) Bad</span>
                            </div>

                            <h4>Formula Components</h4>
                            <ul style="font-size:13px;">
                                <li><strong>Base WR</strong> - Champion's historical win %</li>
                                <li><strong>Class Adj</strong> - (class matchup - 50) × 0.6, ±15 pts max</li>
                                <li><strong>Supporter Adj</strong> - Elim diff helps, dep diff hurts</li>
                                <li><strong>Gacha Threat</strong> - Penalty vs Strikers/Grinders with high-dep teams</li>
                            </ul>

                            <p style="color:#ff9800;font-size:12px;margin-top:10px;"><strong>Key:</strong> Elim supporters = good. Deposit supporters = usually bad (sacrifice offense).</p>

                            <h4 style="margin-top:15px;">Fantasy Points (FP)</h4>
                            <p style="font-size:12px;">Elims×80 + Deps×50 + Wart×0.56 + Win×300</p>
                            <button class="close-info" onclick="document.getElementById('ms-info-overlay').classList.remove('show')">Got it</button>
                        </div>
                    </div>
                </div>
                <div id="bucket-stats" class="bucket-stats"></div>
                <div class="controls">
                    <input type="text" id="analysis-search" placeholder="Search champions...">
                    <select id="analysis-result-filter">
                        <option value="">All Results</option>
                        <option value="W">Wins Only</option>
                        <option value="L">Losses Only</option>
                    </select>
                    <select id="analysis-ms-filter">
                        <option value="">All Grades</option>
                        <option value="A">Grade A+ (must-play)</option>
                        <option value="B">Grade B+ (good)</option>
                        <option value="C">Grade C+ (coin flip)</option>
                        <option value="D">Grade D+ (avoid)</option>
                    </select>
                </div>
                <div id="analysis-table"></div>
            </section>

            <section id="class-changes" class="tab-content">
                <div class="class-changes-header">
                    <h2>Class Changes</h2>
                    <p>Mokis that have recently changed class. Changes detected from match history.</p>
                </div>
                <div id="class-changes-summary" class="class-changes-summary"></div>
                <div id="class-changes-table"></div>
            </section>

            <section id="team-comps" class="tab-content">
                <div class="team-comps-header">
                    <h2>Team Compositions</h2>
                    <p>Historical win rates for champion class + supporter role combinations.</p>
                </div>
                <div class="controls">
                    <select id="comp-class-filter">
                        <option value="">All Classes</option>
                        <option value="Defender">Defender</option>
                        <option value="Striker">Striker</option>
                        <option value="Sprinter">Sprinter</option>
                        <option value="Bruiser">Bruiser</option>
                        <option value="Center">Center</option>
                        <option value="Grinder">Grinder</option>
                        <option value="Forward">Forward</option>
                        <option value="Flanker">Flanker</option>
                        <option value="Support">Support</option>
                        <option value="Anchor">Anchor</option>
                    </select>
                    <select id="comp-min-games">
                        <option value="50">50+ games</option>
                        <option value="30">30+ games</option>
                        <option value="20">20+ games</option>
                        <option value="10">10+ games</option>
                    </select>
                </div>
                <div id="team-comps-table"></div>
            </section>
        </main>
    </div>

    <!-- Tabulator JS -->
    <script src="https://unpkg.com/tabulator-tables@5.5.0/dist/js/tabulator.min.js"></script>

    <!-- Custom JS -->
    <script src="/static/app.js"></script>
</body>
</html>
